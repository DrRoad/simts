---
title: "Time Series Simulations"
output: 
  rmarkdown::html_vignette:
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{Simulations from Time Series Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: biblio.bib
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(simts)
library(datasets)
```

In this section, we will briefly show some of the `simts` package functionality. In the examples shown here, time series data may take the form of either a one-column `matrix`, `data.frame`, or numeric `vector`.

The following three datasets stored in `simts` will be used as examples.

* [hydro](https://rdrr.io/github/SMAC-Group/datapkg/man/hydro.html): This time series contains the monthly precipitation from 1907 and going to 1972 for total of 781 observations taken from @hipel1994time.
* [savingrt](https://rdrr.io/github/SMAC-Group/datapkg/man/savingrt.html): This dataset contains the US personal saving (after removing seasonal trends) which represent the percentage of income saved from the disposable personal income. This time series with frequency 12 starting in year 1959 and going to 2016 for a total of 691 observations.
* [sales](http://r-exercises.com/wp-content/uploads/2017/04/sales.csv): This dataset contains the US monthly clothing retail sales in millions of dollars taken from 1992 to 2016 for a total of 302 observations. 
* [Nile](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/Nile.html): This time series contains the measurements of the annual flow of the river Nile at Aswan (formerly Assuan), 1871â€“1970, in $10^8 m^3$ taken from Table 1 of @cobb1978problem.

The code below shows how to setup a time series as a `gts()` object. Here, we take samples from each dataset at a rate of `freq` ticks per sample. By applying `plot()` on the result of a `gts()` object, we can observe a simple visualization of our data.

### Hydrology 

Frist, we consider the `hydro` dataset. The code below shows how to construct a `gts` object and plot the resulting time series.

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 1: Monthly  precipitation  series  from  1907  to  1972  taken  from @hipel1994time'}
# Load hydro dataset
data("hydro")

# Simulate based on data
hydro = gts(as.vector(hydro), start = 1907, freq = 12, unit_ts = "in.", 
            name_ts = "Precipitation", data_name = "Precipitation data from Hipel et al., (1994)")

# Plot hydro simulation
plot(hydro)
```

Using the object we created we can now compute its autocorrelation function using the `ACF()` function as follows:

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 2: Empirical autocorrelation function of monthly  precipitation  series  from @hipel1994time'}
# Compute ACF and plot result
hydro_acf = ACF(hydro)
plot(hydro_acf)
```

This graph reveals that this time series does not appear to present any form of autocorrelation. A different visual analysis might be given by a robust estimator of the autocorrelation function.


### Personal Savings 

Similarly to the first dataset, we now consider the `savingrt` time series:

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 3: Monthly  (seasonally  adjusted)  Personal Saving  Rates data  from  January  1959  to  May  2015  provided  by  the Federal  Reserve  Bank  of  St.  Louis.'}
# Load savingrt dataset
data("savingrt")
# Simulate based on data
savingrt = gts(as.vector(savingrt), start = 1959, freq = 12, unit_ts = "%", 
            name_ts = "Saving Rates", data_name = "US Personal Saving Rates")
# Plot savingrt simulation
plot(savingrt)
```

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 4: Empirical autocorrelation function of Personal Saving  Rates data'}
# Compute ACF and plot result
savingrt_acf = ACF(savingrt)
plot(savingrt_acf)
```

This graph indicates that this time series is likely to present some non-stationary features. This is actually not a surprising observation as such data are often assumed to be close to a random walk model.


### Retail Sales

Let's consider the next dataset, the `sales` time series:

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 1: Monthly Clothing Retail Sales in US for 1992-2016'}
# Load sales dataset
data("sales")

# Simulate based on data
sales = gts(as.vector(sales), start = 1992, freq = 12, name_time = "Month",
            unit_ts = "millions of dollars", name_ts = "Retail.trade.clothing", 
            data_name = "Monthly Clothing Retail Sales in US for 1992-2016")


# Plot sales simulation
plot(sales)
```


After creating the time series object, now we can compute its autocorrelation function and partial autocorrelation function by using `ACF()` and `PACF()` as follows:

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 2: Empirical autocorrelation function of Monthly Clothing Retail Sales in US for 1992-2016'}
# Compute ACF and plot result
sales_acf = ACF(sales)
plot(sales_acf)
```


```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 3: Empirical partial autocorrelation function of Monthly Clothing Retail Sales in US for 1992-2016'}
#Compute PACF and plot result
sales_pacf = PACF(sales)
plot(sales_pacf)
```

You can also use `corr_analysis()` function in the package to get the same results as above:  

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 4: Empirical ACF and PACF of Monthly Clothing Retail Sales in US for 1992-2016'}
# Compute and plot ACF and PACF
sales_corr = corr_analysis(sales)

# Get ACF and PACF values
sales_acf = sales_corr$ACF
sales_pacf = sales_corr$PACF
```

The autocorrelation graph reveals that there exits some seasonal features in this time series. As we can expect, the sales data is likely to present similar behaviors from year to year.


### Nile River Flow 

Finally, we consider the last dataset in the code below:

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 5: Plot of Annual Nile river flow from 1871-1970'}
# Load Nile dataset
Nile = datasets::Nile

# Simulate based on data
nile = gts(as.vector(Nile), start = 1871, end = 1970, freq = 1, 
           unit_ts = bquote(paste(10^8," ",m^3)), name_ts = "Flow", 
           name_time = "Years", data_name = "Annual Flow of the Nile River")

# Plot Nile simulation 
plot(nile)
```

```{r, fig.align='center', fig.height = 4, fig.width = 7.25, fig.cap = 'Figure 6: Empirical autocorrelation function of the Nile river flow data'}
# Compute ACF and plot result
nile_acf = ACF(nile)
plot(nile_acf)
```

## Missing features:

- Add new dataset
- Add robust estimators
- Add content of "Sample Analyses using exts" to the packages and the appropriate vignettes
- Add content (similarly to above) of "Experimental Time Series Features"
- Check slides and add content to this page (see forecast function)


## References
